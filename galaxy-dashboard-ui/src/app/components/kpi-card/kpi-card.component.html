<!-- Ultra-Premium KPI Widget - Notion/Linear Style -->
<div class="premium-kpi-widget group h-full relative overflow-hidden">
  
  <!-- Glass morphism background with premium gradients -->
  <div class="absolute inset-0 bg-gradient-to-br from-white/95 via-slate-50/90 to-emerald-50/95 backdrop-blur-2xl"></div>
  <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top_left,rgba(16,185,129,0.06),transparent_50%)]"></div>
  <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_right,rgba(34,197,94,0.04),transparent_50%)]"></div>
  <div class="absolute inset-0 border border-gray-200/60 rounded-3xl"></div>
  <div class="absolute inset-0 border border-white/60 rounded-3xl"></div>
  
  <!-- Main content container -->
  <div class="relative z-10 h-full flex flex-col p-4">
    
    <!-- Header Section with Premium Design -->
    <div class="flex items-center justify-between mb-3 flex-shrink-0">
      <div class="flex items-center space-x-4">
        <!-- Premium title section -->
        <div class="flex items-center space-x-3">
          <div class="w-1 h-8 bg-gradient-to-b from-emerald-500 via-green-500 to-teal-500 rounded-full shadow-lg"></div>
          <div>
            <h3 class="text-xl font-bold bg-gradient-to-r from-gray-900 via-gray-800 to-gray-700 bg-clip-text text-transparent leading-tight">{{data.title}}</h3>
            <div class="flex items-center space-x-2 mt-1">
              <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse shadow-sm"></div>
              <span class="text-xs font-semibold text-gray-500 uppercase tracking-wider">Live Insights</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Premium controls section -->
      <div class="flex items-center space-x-3">
        <!-- Widget actions -->
        <app-widget-header
          [title]="''"
          [isLoading]="isRefreshing"
          [dashboardWidgetId]="data?.dashboardWidgetId"
          [widgetData]="getExpandedData()"
          (onRefresh)="handleRefresh()"
          (onExpand)="handleExpand($event)"
          (onClose)="handleClose($event)"
          class="premium-widget-actions">
        </app-widget-header>
      </div>
    </div>



    <!-- Loading State -->
    <div *ngIf="isRefreshing" class="flex-1 flex items-center justify-center min-h-[200px]">
      <div class="text-center">
        <div class="relative inline-flex items-center justify-center w-20 h-20 mb-6">
          <div class="absolute inset-0 bg-gradient-to-br from-emerald-500 via-green-500 to-teal-500 rounded-3xl animate-pulse shadow-2xl"></div>
          <div class="relative w-10 h-10 border-4 border-white border-t-transparent rounded-full animate-spin"></div>
        </div>
        <p class="text-base font-semibold text-gray-700 mb-2">Refreshing KPI data</p>
        <p class="text-sm text-gray-500">Calculating metrics...</p>
      </div>
    </div>

    <!-- Ultra-Premium KPI Value Display -->
    <div *ngIf="!isRefreshing" class="flex-1 relative flex flex-col justify-center">
      <!-- Value backdrop with subtle gradient -->
      <div class="absolute inset-4 bg-gradient-to-br from-gray-50/30 to-emerald-50/20 rounded-2xl"></div>
      
      <!-- Main KPI value container -->
      <div class="relative z-10 text-center p-4">
        <!-- Compact animated value -->
        <div class="mb-3">
          <span class="kpi-value-animated text-3xl md:text-4xl lg:text-5xl font-bold bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 bg-clip-text text-transparent">
            {{ animatedValue | number:'1.0-0' }}
          </span>
        </div>
        
        <!-- Subtitle/Description -->
        <div *ngIf="data.subtitle" class="text-gray-600 text-base font-medium">
          {{ data.subtitle }}
        </div>
      </div>
      
      <!-- Premium overlay effects -->
      <div class="absolute inset-0 pointer-events-none rounded-2xl overflow-hidden">
        <!-- Subtle gradient overlay at edges -->
        <div class="absolute top-0 left-0 right-0 h-8 bg-gradient-to-b from-white/40 to-transparent"></div>
        <div class="absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-white/40 to-transparent"></div>
        <div class="absolute top-0 bottom-0 left-0 w-8 bg-gradient-to-r from-white/40 to-transparent"></div>
        <div class="absolute top-0 bottom-0 right-0 w-8 bg-gradient-to-l from-white/40 to-transparent"></div>
        
        <!-- Premium glow effect -->
        <div class="absolute inset-0 border border-white/20 rounded-2xl"></div>
      </div>
    </div>
  </div>
  
  <!-- Premium hover glow effect -->
  <div class="absolute inset-0 rounded-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none bg-gradient-to-br from-emerald-100/10 via-transparent to-green-100/10"></div>
</div>
